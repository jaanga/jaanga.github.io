<!doctype html>
<html lang=en >
<head>
<meta charset=utf-8 >
<title>Time Now R1</title>
<!--
<meta name = viewport content = 'width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0' />
<meta name=viewport content='initial-scale=1, minimal-ui, minimum-scale=1, maximum-scale=1, user-scalable=no, width=device-width' >
-->
<meta name=viewport content='width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no,minimal-ui' >
<meta name=description content='' >
<meta name=keywords content='WebGL,Three.js,Tween.js,JavaScript,GitHub,FOSS,3D,STEM' >
<meta name=date content='' >
</head>
<body>
<script>

	var lat = 37.8;
	var lon = -122.4;

	var locations = 

	[

//		[ , , ''],

		[ 21.3, 157.8167, 'Honolulu'],
		[ 32.6333, 51.6500, 'Isfahan' ],
		[ 51.5072, -0.1275, 'London' ],
		[ 18.975, 72.8258, 'Mumbai'],
		[ 40.712, -74.0059, 'New York' ],
		[ -22.9068, -43.1729, 'Rio de Janeiro' ],
		[ 37.796, -122.398, 'San Francisco' ],
		[ 31.2, 121.5, 'Shanghai'],
		[ -33.8650, 151.2094, 'Sydney' ]

	];

	var date, dateUTC;

	init();

	function init() {

		var css = document.body.appendChild( document.createElement( 'style' ) );
		css.innerHTML =

			'body { font: 12pt monospace; margin: 0; }' +
			'h2 { margin: 0; }' +
			'a { text-decoration: none; }' +

			'button, input[type=button] { background-color: #eee; border: 2px #eee solid; color: #888; }' +

			'input[type=range] { -webkit-appearance: none; -moz-appearance: none; background-color: silver; width: 160px; }' +
			'input[type=range]::-moz-range-thumb { background-color: #888; border-radius: 0; width: 10px; }' +
			'input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; background-color: #888; height: 20px; width: 10px; }' +

			'#menu { margin: 0 20px; max-width: 800px; position: absolute; }' +

		'';

		var menu = document.body.appendChild( document.createElement( 'div' ) );
		menu.id = 'menu';
		menu.innerHTML =

			'<h2>' +
			'	<a href="" >' + document.title + '</a>' +
			'	<a href=http://jaanga.github.io/cookbook-html/snippets/ >&#x24D8;</a>' +
			'</h2>' +

			'<div id=info ></div>' +

		'';

		getDate();

	}

	function getDate() {

		var txt = 
			'<p><a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date target="_blank" >JavaScript Date Docs</a></p>' +
			'<p><a href=https://en.wikipedia.org/wiki/Coordinated_Universal_Time target="_blank" >UTC</a></p>' +
			'<h3>Local Time</h3>' +
		'';
		var a = '<p>';
		var b = '</p>';

		date = new Date();

		txt += a + 'new Date() = ' + date + b;

//		var tim = date.getTime();

		txt += a + 'date.getTime() = ' + date.getTime() + b;

//		txt += a + 'date.UTC() = ' + date.UTC() + b;

//		txt += a + 'date.now() = ' + date.now() + b;

//		txt += a + 'date.parse() = ' + date.parse() + b;

		txt += a + 'date.getDate() = ' + date.getDate() + b;

		txt += a + 'date.getDay() = ' + date.getDay() + b;

		txt += a + 'date.getFullYear() = ' + date.getFullYear() + b;

		txt += a + 'date.getHours() = ' + date.getHours() + b;

		txt += a + 'date.getMilliseconds() = ' + date.getMilliseconds() + b;

		txt += a + 'date.getMinutes() = ' + date.getMinutes() + b;

		txt += a + 'date.getMonth() = ' + date.getMonth() + b;

		txt += a + 'date.getSeconds() = ' + date.getSeconds() + b;

		txt += a + 'date.getTime() = ' + date.getTime() + b;

		txt += a + 'date.getTimezoneOffset() = ' + date.getTimezoneOffset() + b;

		txt += a + 'date.getUTCDate() = ' + date.getUTCDate() + b;

		txt += a + 'date.getUTCDay() = ' + date.getUTCDay() + b;

		txt += a + 'date.getUTCFullYear() = ' + date.getUTCFullYear() + b;

		txt += a + 'date.getUTCHours() = ' + date.getUTCHours() + b;

		txt += a + 'date.getUTCMilliseconds() = ' + date.getUTCMilliseconds() + b;

		txt += a + 'date.getUTCMinutes() = ' + date.getUTCMinutes() + b;

		txt += a + 'date.getUTCMonth() = ' + date.getUTCMonth() + b;

		txt += a + 'date.getUTCSeconds() = ' + date.getUTCSeconds() + b;

		txt += a + 'date.getYear() = ' + date.getYear() + b;

		txt += a + 'date.toDateString() = ' + date.toDateString() + b;

		txt += a + 'date.toGMTString() = ' + date.toGMTString() + b;

		txt += a + 'date.toISOString() = ' + date.toISOString() + b;

		txt += a + 'date.toJSON() = ' + date.toJSON() + b;

		txt += a + 'date.toLocaleDateString() = ' + date.toLocaleDateString() + b;

//		txt += a + 'date.toLocaleFormat() = ' + date.toLocaleFormat() + b;

		txt += a + 'date.toLocaleString() = ' + date.toLocaleString() + b;

		txt += a + 'date.toLocaleTimeString() = ' + date.toLocaleTimeString() + b;

//		txt += a + 'date.toSource() = ' + date.toSource() + b;

		txt += a + 'date.toString() = ' + date.toString() + b;

		txt += a + 'date.toTimeString() = ' + date.toTimeString() + b;

		txt += a + 'date.toUTCString() = ' + date.toUTCString() + b;

		txt += a + 'date.valueOf() = ' + date.valueOf() + b;


/*
		txt += a + 'date.() = ' + date.() + b;

*/


		txt += '<h3>UTC Time </h3>';

		txt += '<p>You may think the following should give you UTC time. It does not.</p>';

		dateUTC = new Date( Date.UTC( date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(),
			date.getUTCMinutes(), date.getUTCSeconds(), date.getUTCMilliseconds() ) );

		txt += a + 'new Date( Date.UTC( date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(), date.getUTCHours(), ' +
			' date.getUTCMinutes(), date.getUTCSeconds(), date.getUTCMilliseconds() ) ) = ' + 
			dateUTC + ' << gets converted to local time' + b;

		txt += a + 'dateUTC.getTime() = ' + dateUTC.getTime() + ' << QED' + b;

		txt += a + '***' + b;

		localOffset = date.getTimezoneOffset();

		txt += a + 'date.getTimezoneOffset = ' + localOffset + ' << offset in minutes' + b;

		txt += a + 'date.getTimezoneOffset / 60 = ' + localOffset / 60 + ' << offset in hours' + b;

		txt += a + 'date.getTimezoneOffset() * 60000 = ' + localOffset * 60000 + ' << offset in milliseconds' + b;

		utc = date.getTime() + localOffset * 60000;

		txt += a + ' date.getTime + localOffset * 60000 = ' + utc + ' << UTC ' + b;


		dateUTC = new Date( utc );

		txt += a + 'dateUTC = new Date( utc ) = ' + dateUTC + ' << note automatic conversion to local time format. Ugh.' + b;

		txt += a + 'dateUTC.getUTCHours() = ' + dateUTC.getUTCHours() + ' << watch out' + b;

		txt += a + 'dateUTC.getHours() = ' + dateUTC.getHours() + ' << OK' + b;

		txt += a + 'dateUTC.toISOString() = ' + dateUTC.toISOString() + ' << watch out' + b;

		txt += a + 'dateUTC.toISOString() = ' + dateUTC.toUTCString() + ' << watch out' + b;

		txt += a + 'dateUTC.toDateString() = ' + dateUTC.toDateString() + ' << OK' + b;

		txt += a + 'dateUTC.toLocaleDateString() = ' + dateUTC.toLocaleDateString() + ' << OK' + b;

		txt += a + 'dateUTC.toTimeString() = ' + dateUTC.toTimeString() + ' << watch out' + b;

		txt += a + 'dateUTC.toLocaleTimeString() = ' + dateUTC.toLocaleTimeString() + ' << OK' + b;

		txt += '<h3>Time Now Given Lat Lon </h3>' +
			'<p>Given a UTC time of ' + dateUTC.getHours() + ':' + dateUTC.getMinutes() + '</p>';


		info.innerHTML = txt;

		timeStamp = dateUTC.getTime() / 1000;

//console.log( 'ts', timeStamp );

		for ( var i = 0; i < locations.length; i++ ) {

			loc = locations[ i ];

// https://developers.google.com/maps/documentation/timezone/intro

			request = 'https://maps.googleapis.com/maps/api/timezone/json?location=' + loc[ 0 ] + ',' + loc[ 1 ] + '&timestamp=' + timeStamp;

//console.log( '', request );

			requestFile( request, loc );

		}



console.log( '', date );

	}

	function requestFile( fileName, locate ) {

		var xhr = new XMLHttpRequest();
		xhr.open( 'GET', fileName, true );
		xhr.onreadystatechange = callback;
		xhr.send( null );

			function callback() {

				if ( xhr.readyState !== 4  ) { return; }

				time = JSON.parse( xhr.responseText );

				updateInfo( time, locate );

//console.log( 'time ', time );

			}

	}

	function updateInfo( time, locate ) {

		if ( time.status === 'OK' ) {

			offset = time.rawOffset + time.dstOffset;

			remoteTime = calculateLocalTime( dateUTC.getTime(), offset );

			info.innerHTML += 

				'<h3>' + locate[ 2 ] + '</h3>' +
				'<p> lat: ' + locate[ 0 ] + ' lon: ' + locate[ 1 ] + '</p>' +
				'<p>Time ZoneID:' + time.timeZoneId + '</p>' +
				'<p>Time zone: ' + time.timeZoneName + '</p>' +
				'<p>Offset in hours: ' + offset / 3600 + '</p>' +
				'<p>The local date and time is: ' + remoteTime.toLocaleString() + '</p>' +
				'<p> The local universal time is:' + remoteTime.getTime() + '</p>' +

			'';

		} else {

			info.innerHTML += 'the location is timeless';

		}

	}

	function calculateLocalTime( date, offset ) {

		newDate = new Date( date + ( 1000 * offset ) );

		return  newDate;

	}


// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date

/* 

Date.UTC()
Date.now()
Date.parse()
Date.prototype.getDate()
Date.prototype.getDay()
Date.prototype.getFullYear()
Date.prototype.getHours()
Date.prototype.getMilliseconds()
Date.prototype.getMinutes()
Date.prototype.getMonth()
Date.prototype.getSeconds()
Date.prototype.getTime()
Date.prototype.getTimezoneOffset()
Date.prototype.getUTCDate()
Date.prototype.getUTCDay()
Date.prototype.getUTCFullYear()
Date.prototype.getUTCHours()
Date.prototype.getUTCMilliseconds()
Date.prototype.getUTCMinutes()
Date.prototype.getUTCMonth()
Date.prototype.getUTCSeconds()
Date.prototype.getYear()
Date.prototype.setDate()
Date.prototype.setFullYear()
Date.prototype.setHours()
Date.prototype.setMilliseconds()
Date.prototype.setMinutes()
Date.prototype.setMonth()
Date.prototype.setSeconds()
Date.prototype.setTime()
Date.prototype.setUTCDate()
Date.prototype.setUTCFullYear()
Date.prototype.setUTCHours()
Date.prototype.setUTCMilliseconds()
Date.prototype.setUTCMinutes()
Date.prototype.setUTCMonth()
Date.prototype.setUTCSeconds()
Date.prototype.setYear()
Date.prototype.toDateString()
Date.prototype.toGMTString()
Date.prototype.toISOString()
Date.prototype.toJSON()
Date.prototype.toLocaleDateString()
Date.prototype.toLocaleFormat()
Date.prototype.toLocaleString()
Date.prototype.toLocaleTimeString()
Date.prototype.toSource()
Date.prototype.toString()
Date.prototype.toTimeString()
Date.prototype.toUTCString()
Date.prototype.valueOf()
Date.prototype[@@toPrimitive]

*/

</script>
</body>
</html>